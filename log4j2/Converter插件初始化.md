# 简单使用## 依赖引入- 插件定义 参考的org.apache.logging.log4j.core.pattern.DatePatternConverter|org.apache.skywalking.apm.toolkit.log.log4j.v2.x.SkyWalkingContextConverter```javapackage com.alibaba.csp.sentinel.dashboard.log4j;import org.apache.logging.log4j.core.config.plugins.Plugin;import org.apache.logging.log4j.core.pattern.ConverterKeys;import org.apache.logging.log4j.core.pattern.DatePatternConverter;import org.apache.logging.log4j.core.pattern.PatternConverter;import org.apache.logging.log4j.util.PerformanceSensitive;/** * @Author liqiang * @Description 自定义 * @Date 2025/05/08/10:18 */@Plugin(name = "DatePatternConverter", category = PatternConverter.CATEGORY)@ConverterKeys({"d", "date"})@PerformanceSensitive("allocation")public class SentinelDatePatternConverter implements PatternConverter {	DatePatternConverter datePatternConverter = null;	private SentinelDatePatternConverter(final String[] options) {		datePatternConverter = DatePatternConverter.newInstance(options);	}	@Override	public void format(Object obj, StringBuilder toAppendTo) {		datePatternConverter.format(obj, toAppendTo);	}	@Override	public String getName() {		return datePatternConverter.getName();	}	@Override	public String getStyleClass(Object e) {		return datePatternConverter.getStyleClass(e);	}}```# 插件初始化源码```textorg.apache.logging.log4j.core.pattern.PatternParser#PatternParser-> 加载初始化插件org.apache.logging.log4j.core.config.plugins.util.PluginManager#collectPlugins->初始化convertorg.apache.logging.log4j.core.pattern.PatternParser#parseorg.apache.logging.log4j.core.pattern.PatternParser#createConverter-> 根据插件信息 反射调用进行初始化org.apache.logging.log4j.core.pattern.PatternParser#createConverter```# 日志输出选择插件```textorg.apache.logging.log4j.core.async.AsyncLoggerConfig#log->通过配置的append 进行输出 比如 file console等org.apache.logging.log4j.core.config.LoggerConfig#processLogEventorg.apache.logging.log4j.core.appender.AbstractOutputStreamAppender#tryAppend->使用Append的Layout信息进行输出格式构建org.apache.logging.log4j.core.layout.PatternLayout#encode->使用对应Formater进行占位符填充，内部封装了Convertorg.apache.logging.log4j.core.layout.PatternLayout.PatternFormatterPatternSerializer#toSerializable```